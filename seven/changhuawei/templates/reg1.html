
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>云主机平台</title>
    <link rel="shortcut icon" type="image/png" href="/static/images/cloud.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- basic styles -->

    <link href="/static/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="/static/css/font-awesome.min.css"/>

    <!--[if IE 7]>
      <link rel="stylesheet" href="/static/css/font-awesome-ie7.min.css" />
    <![endif]-->

    <!-- page specific plugin styles -->

    <!-- fonts -->

    <!-- ace styles -->

    <link rel="stylesheet" href="/static/css/ace.min.css"/>
    <link rel="stylesheet" href="/static/css/ace-rtl.min.css"/>
    <link rel="stylesheet" href="/static/css/ace-skins.min.css"/>

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="/static/css/ace-ie.min.css" />
    <![endif]-->

    <!-- inline styles related to this page -->

    <!-- ace settings handler -->

    <script src="/static/js/ace-extra.min.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

    <!--[if lt IE 9]>
    <script src="/static/js/html5shiv.js"></script>
    <script src="/static/js/respond.min.js"></script>
    <![endif]-->

    
    <link rel="stylesheet" href="/static/css/select2.css"/>


</head>

<body>




<nav class="top-bar" data-topbar>
    
    <style>
        .ui-autocomplete {
            position: absolute;
            top: 100%;
            left: 0;
            z-index: 1000;
            float: left;
            display: none;
            min-width: 160px;
            padding: 4px 0;
            margin: 0 0 10px 25px;
            list-style: none;
            background-color: #ffffff;
            border-color: #ccc;
            border-color: rgba(0, 0, 0, 0.2);
            border-style: solid;
            border-width: 1px;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            -moz-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            -webkit-background-clip: padding-box;
            -moz-background-clip: padding;
            background-clip: padding-box;
            *border-right-width: 2px;
            *border-bottom-width: 2px;
        }

        .ui-menu-item > a.ui-corner-all {
            display: block;
            padding: 3px 15px;
            clear: both;
            font-weight: normal;
            line-height: 18px;
            color: #555555;
            white-space: nowrap;
            text-decoration: none;
        }

        .ui-state-hover, .ui-state-active {
            color: #ffffff;
            text-decoration: none;
            background-color: #0088cc;
            border-radius: 0px;
            -webkit-border-radius: 0px;
            -moz-border-radius: 0px;
            background-image: none;
        }

        .nav.navbar-nav > li > a:hover, .nav.navbar-nav > li > a:focus {
            background-color: #E7E7E7;
            color: #555555;
        }

        li > span > input[type="text"] {
            border-radius: 50px !important;

        }
    </style>
    <div class="navbar navbar-default" id="navbar">
        <script type="text/javascript">
            try {
                ace.settings.check('navbar', 'fixed')
            } catch (e) {
            }
        </script>

 
                
                
            </div>

            <div class="page-content">
                <div class="row">
                    <div class="col-xs-12">
                        <!-- PAGE CONTENT BEGINS -->
                        
    <div class="page-header">
        <h1>
           用户管理
        </h1>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <div class="row-fluid">
                <div class="span12">
                    <div class="widget-box">

                    </div>

                    <div class="widget-body">
                        <div class="widget-main" id="role_manage">
                            <!--
                            <div class="row">
                                <div class="col-sm-2 ">
                                    <label class="label label-lg label-success arrowed-right" style="width: 80px">
                                        筛选条件</label>
                                </div>
                                <div class=" col-sm-3  ">
                                    <select id="data_center" style="width: 250px;" v-model="current_zone">
                                        <option v-for="zone in zones"
                                                value="[[$index]]">
                                            [[zone.name]]
                                        </option>
                                    </select>
                                </div>
                                <div class=" col-sm-3">
                                    <select id="cluster" style="width: 250px;" onchange="vue.cluster_change()">
                                        <option v-for="cluster in clusters" value="[[cluster.name]]">
                                            [[cluster.name == '-1' ? '所有集群' : cluster.name]]
                                        </option>
                                    </select>
                                </div>
                            </div>
-->
                            <div class="row">
                                <div class="col-xs-12">
                                    <h4 class="header smaller lighter blue">
                                        <div class="col-sm-2">
                                            用户列表
                                        </div>
                                        <div class="align-right" style="margin-right: 20px;margin-bottom: 5px">
                                            <button class="btn btn-success btn-sm" data-toggle="modal"
                                                    data-target="#add_role">新增用户
                                            </button>
                                        </div>
                                    </h4>

                                    <div class="table-responsive">
                                        <table id="auth_list" class="table table-striped table-bordered table-hover">
                                            <thead>
                                            <tr>
                                                <th class="center">id</th>
                                                <th class="center" style="width: 10%">权限</th>
                                                <th class="center">账户</th>
                                                <th class="center">密码</th>
                                                <th class="center">email</th>
                                                <!-- <th class="center">xx</th> -->
                                                <th class="center">操作</th>
                                            </tr>
                                            </thead>

                                            <tbody>
                                            {% for list in result %}
                                            <tr class="center" v-for="auth in role_list| orderBy 'id' -1">
                                                <td>{{ list.id  }}</td>
                                                <td>{{ list.role }}</td>
                                                <td>{{ list.username }}</td>
                                                <td>{{ list.password }}</td>
                                                <td>{{ list.email }}</td>
                                                <!-- <td>[[auth.template_vm_limit]]</td> -->
                                                
                                                <td>
                                                    <button class="btn btn-xs btn-warning"
                                                            @click="upadte_auth(auth.id)">修改
                                                    </button>
                                                    <button class="btn btn-xs btn-danger" @click="delete_auth(auth.id)">
                                                        删除
                                                    </button>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div id="add_role" class="modal fade form-horizontal" style="height: auto">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                            <h4 class="modal-title">
                                                <p class="bigger-110 bolder grey">
                                                    <i class="icon-hand-right blue bigger-120"></i>
                                                    新增角色信息：
                                                </p>
                                            </h4>
                                        </div>
                                        <div class="row modal-body">
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 80px;font-size: 16px">角色名：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="text" id="role_name"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1">
                                                </div>
                                                <div class="col-xs-2">
                                                    <label style="width: 80px;font-size: 16px">选择权限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <div class="col-sm-4" v-for="(key,value) in permission_dict">
                                                        <input type="checkbox" name="perm_check"
                                                               class="ace ace-checkbox" value="[[key]]">
                                                        <label class="lbl" for="perm_check" style="font-size: 14px">[[value]]</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 100px;font-size: 16px">快照总量上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0" id="snap_num" value="0"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 100px;font-size: 16px">模板总量上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0" id="temp_num"  value="0"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 100px;font-size: 16px">虚机快照上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0" id="snap_vm_limit" value="0"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 100px;font-size: 16px">虚机模板上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0" id="temp_vm_limit"  value="0"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-warning " data-dismiss="modal">取消
                                            </button>
                                            <button id="ok_machine" type="button" class="btn btn-success "
                                                    data-dismiss="modal" @click="add_role()">确定
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="update_role" class="modal fade form-horizontal" style="height: auto">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                            <h4 class="modal-title">
                                                <p class="bigger-110 bolder grey">
                                                    <i class="icon-hand-right blue bigger-120"></i>
                                                    修改角色信息：
                                                </p>
                                            </h4>
                                        </div>
                                        <div class="row modal-body">
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 80px;font-size: 16px">角色名：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="text" id="update_role_name" v-model="update_role.name"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1">
                                                </div>
                                                <div class="col-xs-2">
                                                    <label style="width: 80px;font-size: 16px">选择权限：</label>
                                                </div>
                                                <div class="col-xs-8" id="checkbox_list">
                                                    <div class="col-sm-4" >
                                                        <input type="checkbox" name="update_perm_check"
                                                               class="ace ace-checkbox" value="[[key]]" >
                                                        <label class="lbl" for="perm_check" style="font-size: 14px">[[value]]</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 80px;font-size: 16px">快照总量上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0" id="update_snap_num" v-model="update_role.snapshot_num"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 80px;font-size: 16px">模板总量上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0" id="update_temp_num" v-model="update_role.template_num"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 100px;font-size: 16px">虚机快照上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0" v-model="update_role.snapshot_vm_limit"/>
                                                </div>
                                            </div>
                                            <div class="vspace-6"></div>
                                            <div class="row">
                                                <div class="col-xs-1"></div>
                                                <div class="col-xs-2">
                                                    <label style="width: 100px;font-size: 16px">虚机模板上限：</label>
                                                </div>
                                                <div class="col-xs-8">
                                                    <input type="number" min="0"  v-model="update_role.template_vm_limit"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-warning " data-dismiss="modal">取消
                                            </button>
                                            <button id="ok_machine" type="button" class="btn btn-success "
                                                    data-dismiss="modal" @click="ensure_update(update_role.id)">确定
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- /widget-main -->
                    </div>
                    <!-- /widget-body -->
                </div>
            </div>
        </div>
    </div>
    <!-- /.col -->
    <div class="ace-settings-container" id="ace-settings-container"></div>

                        <!-- PAGE CONTENT ENDS -->
                    </div><!-- /.col -->
                </div><!-- /.row -->
            </div><!-- /.page-content -->
        </div><!-- /.main-content -->

        <!--        <div class="ace-settings-container" id="ace-settings-container">
                            <div class="btn btn-app btn-xs btn-warning ace-settings-btn" id="ace-settings-btn">
                                <i class="icon-cog bigger-150"></i>
                            </div>

                            <div class="ace-settings-box" id="ace-settings-box">
                                <div>
                                    <div class="pull-left">
                                        <select id="skin-colorpicker" class="hide">
                                            <option data-skin="default" value="#438EB9">#438EB9</option>
                                            <option data-skin="skin-1" value="#222A2D">#222A2D</option>
                                            <option data-skin="skin-2" value="#C6487E">#C6487E</option>
                                            <option data-skin="skin-3" value="#D0D0D0">#D0D0D0</option>
                                        </select>
                                    </div>
                                    <span>&nbsp; Choose Skin</span>
                                </div>

                                <div>
                                    <input type="checkbox" class="ace ace-checkbox-2" id="ace-settings-navbar" />
                                    <label class="lbl" for="ace-settings-navbar"> Fixed Navbar</label>
                                </div>

                                <div>
                                    <input type="checkbox" class="ace ace-checkbox-2" id="ace-settings-sidebar" />
                                    <label class="lbl" for="ace-settings-sidebar"> Fixed Sidebar</label>
                                </div>

                                <div>
                                    <input type="checkbox" class="ace ace-checkbox-2" id="ace-settings-breadcrumbs" />
                                    <label class="lbl" for="ace-settings-breadcrumbs"> Fixed Breadcrumbs</label>
                                </div>

                                <div>
                                    <input type="checkbox" class="ace ace-checkbox-2" id="ace-settings-rtl" />
                                    <label class="lbl" for="ace-settings-rtl"> Right To Left (rtl)</label>
                                </div>

                                <div>
                                    <input type="checkbox" class="ace ace-checkbox-2" id="ace-settings-add-container" />
                                    <label class="lbl" for="ace-settings-add-container">
                                        Inside
                                        <b>.container</b>
                                    </label>
                                </div>
                            </div>
                        </div> /#ace-settings-container -->
    </div><!-- /.main-container-inner -->


</div><!-- /.main-container -->

<!-- basic scripts -->


<!--[if !IE]> -->

<script type="text/javascript">
    window.jQuery || document.write("<script src='/static/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
</script>
<script type="text/javascript">
    window.jQuery || document.write("<script src='/static/js/jquery-1.10.2.min.js'>" + "<" + "/script>");
</script>

<script type="text/javascript">
    if ("ontouchend" in document) document.write("<script src='/static/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
</script>
<script src="/static/js/jquery-ui-1.10.3.full.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/typeahead-bs2.min.js"></script>

<!-- page specific plugin scripts -->

<!-- ace scripts -->

<script src="/static/js/ace-elements.min.js"></script>
<script src="/static/js/ace.min.js"></script>


    <script type="text/javascript" src="/static/js/bootbox.min.js"></script>
    <script src="/static/js/vue.min.js"></script>
    <script src="/static/js/vue-resource.js"></script>
    <script src="/static/js/virtual/vue_common.js"></script>
    <script src="/static/js/virtual/role_manage.js"></script>


</body>
</html>
